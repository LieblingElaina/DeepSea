## 整体模块解耦架构（基于功能职责）

### 1. 角色系统（Player System）

| 模块   | 说明                  | 接口                             |
| ---- | ------------------- | ------------------------------ |
| 移动模块 | 行走、游泳、攀爬、冲刺、浮潜等状态转换 | `ICharacterMovementController` |
| 输入模块 | 多平台支持（手柄、键鼠）统一映射    | `IInputProvider`               |
| 动画模块 | 控制状态机播放与混合动画        | `ICharacterAnimator`           |
| 状态管理 | 管理生命、能量、护盾、技能CD等    | `ICharacterStats`              |

---

### 2. 战斗系统（Combat System）

|模块|说明|接口|
|---|---|---|
|武器模块|射击、近战、弹药/能量消耗|`IWeaponHandler`、`IAmmunitionSystem`|
|技能系统|主动/被动/模组|`ISkillSystem`|
|命中检测模块|击中反馈、碰撞、攻击范围检测|`IDamageResolver`|
|Boss & 怪攻击命中|对接 AI 动作与攻击判定区域|`IAttackHitbox`|

---

### 3. AI 系统（AI System）

|模块|说明|接口|
|---|---|---|
|AI 行为树|怪物AI、BossAI、队友AI|`IAgentBehaviorTree`|
|怪物生成|波次、类型、难度适应|`ISpawnManager`|
|关卡难度自适应|动态血量、数量、类型调整|`IDifficultyTuner`|
|队友AI行为|战斗协作、补位技能、支援|`ITeammateAIController`|

---

### 4. 关卡系统（Level System）

|模块|说明|接口|
|---|---|---|
|洞穴生成器|基于种子的程序化房间排列|`ILevelGenerator`|
|房间内容分配|场景资源、陷阱、开关、敌人|`IRoomPopulator`|
|环境交互|陷阱、机关、资源点|`IEnvironmentInteractor`|

---

### 5. 联机与同步系统（Multiplayer & Networking）

|模块|说明|接口|
|---|---|---|
|网络架构|主机/客户端|`INetworkManager`|
|状态同步|玩家、怪物、技能、掉落物|`ISyncable`|
|事件广播|技能释放、房间切换、Boss登场等|`IEventDispatcher`|

---

### 6. 系统/功能模块

|模块|说明|接口|
|---|---|---|
|潜艇系统|模块升级、防守、资源分配|`ISubmarineModuleSystem`|
|局外系统|局外装备、技能解锁|`IMetaProgressionSystem`|
|存档系统|局内进度、局外永久升级|`ISaveLoadManager`|
|UI/HUD|血量条、物品栏、地图|`IHUDManager`、`IUIRenderer`|

### 补充一：开发工具与调试模块（Tools & Debugging）

|模块|说明|接口|
|---|---|---|
|调试工具面板|实时查看玩家属性、怪物状态、技能CD等|`IDebugPanelProvider`|
|作弊系统|快捷键刷资源/刷怪/跳关|`ICheatSystem`|
|日志与监控系统|开发日志、战斗事件记录、错误上报|`IDebugLogger`|
|可视化调试器|行为树状态、房间生成预览|`IDebugVisualizer`|

🔧 推荐：主程序搭建 Debug 框架，各成员注册自己的调试内容。

---

### 补充二：渲染与表现模块（Visual & FX System）

|模块|说明|接口|
|---|---|---|
|技能与攻击特效系统|近战、子弹、技能特效播放系统|`IFXController`, `ISkillVFXManager`|
|受击反馈|屏幕震动、击中闪烁、受击音效|`IHitFeedbackHandler`|
|UI 动效系统|UI动效统一驱动|`IUIAnimator`|
|通用渲染控制器|Shader控制、后处理效果|`IRenderEffectManager`|

🎨 推荐：由程序1负责表现逻辑，程序3支持 UI 表现控制。

---

### 补充三：资源与配置管理系统（Assets & Config）

| 模块     | 说明                                 | 接口                   |
| ------ | ---------------------------------- | -------------------- |
| 资源加载系统 | 统一异步加载机制（房间、怪物、技能、UI）              | `IResourceLoader`    |
| 对象池系统  | 对象复用（子弹、敌人、特效）                     | `IObjectPoolManager` |
| 配置系统   | 技能/怪物/房间配置（ScriptableObject 或数据驱动） | `IConfigProvider<T>` |

🛠 推荐：主程序搭建资源加载/配置框架，程序2可维护怪物/关卡数据。

---

## ✅ 最终职责更新表

| 负责人     | 主要职责模块                                                                    | 附加职责模块（建议）                                                |
| ------- | ------------------------------------------------------------------------- | --------------------------------------------------------- |
| **主程序** | - 联机基础框架<br>- 状态同步系统<br>- 角色属性系统<br>- 存档系统<br>- 事件系统 & 对象池<br>- 核心接口/架构搭建 | - 调试工具框架<br>- 配置系统框架（ScriptableObject 管理器）<br>- 技术支持与合并审查 |
| **程序1** | - 移动、战斗、技能系统<br>- 武器与命中检测<br>- 角色动画系统                                     | - 技能 & 近战特效<br>- 击中反馈与屏幕震动<br>- UI 动效控制                   |
| **程序2** | - 怪物AI、队友AI<br>- 怪物/房间生成器<br>- 关卡难度适应                                     | - AI行为树可视化工具<br>- 怪物配置文件管理<br>- 关卡房间调试面板                  |
| **程序3** | - 联机通信<br>- UI系统/HUD<br>- 局外系统（装备解锁、技能树等）                                 | - 音效播放与管理<br>- UI资源加载/缓存管理<br>- UI动画驱动系统                  |

